<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class UpgradeChecker - docker-sync-0.5.7 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><span class="include">Thor::Shell</span>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-get_current_version">::get_current_version</a>
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-check_and_warn">#check_and_warn</a>
    
    <li ><a href="#method-i-docker_sync_update_check">#docker_sync_update_check</a>
    
    <li ><a href="#method-i-last_upgraded_version">#last_upgraded_version</a>
    
    <li ><a href="#method-i-run">#run</a>
    
    <li ><a href="#method-i-should_run">#should_run</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-UpgradeChecker">
  <h1 id="class-UpgradeChecker" class="class">
    class UpgradeChecker
  </h1>

  <section class="description">
    
  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-get_current_version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_current_version</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_current_version-source">
            <pre><span class="ruby-comment"># File lib/docker-sync/upgrade_check.rb, line 41</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get_current_version</span>
  <span class="ruby-identifier">path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-string">&#39;../../../&#39;</span>, <span class="ruby-keyword">__FILE__</span>)
  <span class="ruby-identifier">version</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-node">&quot;#{path}/VERSION&quot;</span>)
  <span class="ruby-identifier">version</span>.<span class="ruby-identifier">strip</span>
  <span class="ruby-identifier">version</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/docker-sync/upgrade_check.rb, line 9</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
  <span class="ruby-ivar">@config</span> = <span class="ruby-constant">DockerSync</span><span class="ruby-operator">::</span><span class="ruby-constant">GlobalConfig</span>.<span class="ruby-identifier">load</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-check_and_warn" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_and_warn</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="check_and_warn-source">
            <pre><span class="ruby-comment"># File lib/docker-sync/upgrade_check.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_and_warn</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;DOCKER_SYNC_SKIP_UPGRADE&#39;</span>]
  <span class="ruby-comment"># this is the upgrade hook for the unison-unox introduction / rename of unison</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.1.0&#39;</span>)
    <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">say_status</span> <span class="ruby-string">&#39;warning&#39;</span>, <span class="ruby-string">&#39;Please be aware that with the strategy &quot;unison&quot; is now called unison-onesided and you might need to migrate. See https://github.com/EugenMayer/docker-sync/wiki/Migration-Guide for more informations&#39;</span>, <span class="ruby-value">:red</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">yes?</span>(<span class="ruby-string">&#39;Shall we continue? (y/N)&#39;</span>)
      <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.2.0&#39;</span>)
    <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">say_status</span> <span class="ruby-string">&#39;warning&#39;</span>, <span class="ruby-string">&quot;A lot changed with 0.2.x! Unison is the default sync, unison-onesided has been REMOVED. If you have been using rsync, have been using unison excludes or you are not sure, please read the upgrade guide or your setup will go lala! : \n\n_Please_ read :): https://github.com/EugenMayer/docker-sync/wiki/1.2-Upgrade-Guide\n\n&quot;</span>, <span class="ruby-value">:red</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">yes?</span>(<span class="ruby-string">&#39;Shall we continue - DID you read it? (y/N)&#39;</span>)
      <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.3.0&#39;</span>)
    <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">say_status</span> <span class="ruby-string">&#39;warning&#39;</span>, <span class="ruby-string">&quot;The installation progress of docker-sync 0.3.0 has changed, brew is now mandatory - you need to uninstall unox ! : \n\n_Please_ read :): https://github.com/EugenMayer/docker-sync/wiki/1.2-Upgrade-Guide\n\n&quot;</span>, <span class="ruby-value">:red</span>

    <span class="ruby-identifier">cmd1</span> = <span class="ruby-string">&#39;sudo rm -f /usr/local/bin/unison-fsmonitor &amp;&amp; brew tap eugenmayer/dockersync &amp;&amp; brew install eugenmayer/dockersync/unox&#39;</span>
    <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">say_status</span> <span class="ruby-string">&#39;ok&#39;</span>, <span class="ruby-identifier">cmd1</span>, <span class="ruby-value">:rwhite</span>

    <span class="ruby-keyword">if</span> <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">yes?</span>(<span class="ruby-string">&#39;I will reinstall unox for you using the above command (y/N)&#39;</span>)
      <span class="ruby-identifier">system</span> <span class="ruby-identifier">cmd1</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span>(<span class="ruby-string">&#39;Please reinstall docker-sync yourself&#39;</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.4.0&#39;</span>)
    <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">say_status</span> <span class="ruby-string">&#39;warning&#39;</span>, <span class="ruby-string">&quot;docker-sync has a new superior default sync strategy native_osx - consider switching to it no matter if you used unison or rsync. \nIt does no longer need Unison/Unox on OSX - no brew needed either. And its a lot thriftier ! \n\n_Please_ read :): https://github.com/EugenMayer/docker-sync/wiki/1.2-Upgrade-Guide\n\n&quot;</span>, <span class="ruby-value">:red</span>

    <span class="ruby-keyword">unless</span> <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">yes?</span>(<span class="ruby-string">&#39;Shall we continue - DID you read it - really :) ? (y/N)&#39;</span>)
      <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.4.1&#39;</span>)
    <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">say_status</span> <span class="ruby-string">&#39;warning&#39;</span>, <span class="ruby-node">&quot;Please add :nocopy to every named-volume mount you defined in your docker-compose-dev.yml! \n\nWhy? : https://github.com/EugenMayer/docker-sync/wiki/2.-Configuration#why-nocopy-is-important\n\n&quot;</span>, <span class="ruby-value">:red</span>

    <span class="ruby-keyword">unless</span> <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">yes?</span>(<span class="ruby-string">&#39;Did you fix your docker-compose-dev.yml? (y/N)&#39;</span>)
      <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.4.2&#39;</span>)
    <span class="ruby-identifier">checker</span> = <span class="ruby-constant">UpdateChecker</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">checker</span>.<span class="ruby-identifier">check_unison_image</span>

    <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">say_status</span> <span class="ruby-string">&#39;warning&#39;</span>, <span class="ruby-string">&quot;The native_osx is NOW ONLY for docker-for-mac, this is due to https://github.com/EugenMayer/docker-sync/issues/346\n\nThat means that unison is picked as a default automatically if you use docker-machine&quot;</span>, <span class="ruby-value">:red</span>

    <span class="ruby-keyword">unless</span> <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">yes?</span>(<span class="ruby-string">&#39;Just wanted you to know that! (y/N)&#39;</span>)
      <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.4.3&#39;</span>)
    <span class="ruby-identifier">checker</span> = <span class="ruby-constant">UpdateChecker</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">checker</span>.<span class="ruby-identifier">check_unison_image</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.4.4&#39;</span>)
    <span class="ruby-identifier">checker</span> = <span class="ruby-constant">UpdateChecker</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">checker</span>.<span class="ruby-identifier">check_unison_image</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.4.5&#39;</span>)
    <span class="ruby-identifier">checker</span> = <span class="ruby-constant">UpdateChecker</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">checker</span>.<span class="ruby-identifier">check_unison_image</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.5.5&#39;</span>)
    <span class="ruby-identifier">checker</span> = <span class="ruby-constant">UpdateChecker</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">checker</span>.<span class="ruby-identifier">check_unison_image</span>

    <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">say_status</span> <span class="ruby-string">&#39;warning&#39;</span>, <span class="ruby-string">&quot;There has been a major unison update. Please clean and restart all your stacks. If you are using the unison strategy, please upgrade unison by doing &#39;brew update &amp;&amp; brew upgrade unison&#39; to upgrade to 2.51.2&quot;</span>, <span class="ruby-value">:red</span>

    <span class="ruby-keyword">unless</span> <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">yes?</span>(<span class="ruby-string">&#39;Just wanted you to know that! (y/N)&#39;</span>)
      <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_upgraded_version</span>) <span class="ruby-operator">&lt;</span>  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;0.5.6&#39;</span>)
    <span class="ruby-identifier">checker</span> = <span class="ruby-constant">UpdateChecker</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">checker</span>.<span class="ruby-identifier">check_unison_image</span>

    <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">say_status</span> <span class="ruby-string">&#39;warning&#39;</span>, <span class="ruby-string">&quot;If you are upgrading from 0.5.4 or below, please run `brew update &amp;&amp; brew upgrade unison` AND `docker-compose down &amp;&amp; docker-sync clean` or `docker-sync-stack clean` since you need to recreate the sync container&quot;</span>, <span class="ruby-value">:red</span>

    <span class="ruby-keyword">unless</span> <span class="ruby-constant">Thor</span><span class="ruby-operator">::</span><span class="ruby-constant">Shell</span><span class="ruby-operator">::</span><span class="ruby-constant">Basic</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">yes?</span>(<span class="ruby-string">&#39;Sync will fail otherwise. Continue? (y/N)&#39;</span>)
      <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># update the upgrade_status</span>
  <span class="ruby-ivar">@config</span>.<span class="ruby-identifier">update!</span> <span class="ruby-string">&#39;upgrade_status&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{UpgradeChecker.get_current_version}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-docker_sync_update_check" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">docker_sync_update_check</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="docker_sync_update_check-source">
            <pre><span class="ruby-comment"># File lib/docker-sync/upgrade_check.rb, line 48</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">docker_sync_update_check</span>
  <span class="ruby-identifier">gem_name</span> = <span class="ruby-string">&#39;docker-sync&#39;</span>
  <span class="ruby-identifier">current_version</span> = <span class="ruby-constant">UpgradeChecker</span>.<span class="ruby-identifier">get_current_version</span>
  <span class="ruby-identifier">checker</span> = <span class="ruby-constant">GemUpdateChecker</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">gem_name</span>, <span class="ruby-identifier">current_version</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">checker</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-last_upgraded_version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">last_upgraded_version</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="last_upgraded_version-source">
            <pre><span class="ruby-comment"># File lib/docker-sync/upgrade_check.rb, line 21</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">last_upgraded_version</span>
  <span class="ruby-ivar">@config</span>[<span class="ruby-string">&#39;upgrade_status&#39;</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-run" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">run</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="run-source">
            <pre><span class="ruby-comment"># File lib/docker-sync/upgrade_check.rb, line 13</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">run</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;DOCKER_SYNC_SKIP_UPGRADE&#39;</span>]
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">should_run</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">check_and_warn</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-should_run" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">should_run</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="should_run-source">
            <pre><span class="ruby-comment"># File lib/docker-sync/upgrade_check.rb, line 25</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">should_run</span>
  <span class="ruby-comment"># get the update_status which is the version of the update hook which has been run already</span>
  <span class="ruby-identifier">upgrade_status</span> = <span class="ruby-identifier">last_upgraded_version</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">upgrade_status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span>
    <span class="ruby-ivar">@config</span>.<span class="ruby-identifier">update!</span> <span class="ruby-string">&#39;upgrade_status&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{UpgradeChecker.get_current_version}&quot;</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">upgrade_status</span>) <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">UpgradeChecker</span>.<span class="ruby-identifier">get_current_version</span>) <span class="ruby-comment"># thats how we compare the version</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

